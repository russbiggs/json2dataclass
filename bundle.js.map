{"version":3,"file":"bundle.js","sources":["../src/pubsub.ts","../src/python-output.ts","../src/index.ts","../src/json-input.ts","../src/import-toggle.ts","../src/datetime-toggle.ts","../src/snake-case-toggle.ts","../src/modal.ts"],"sourcesContent":["interface Events {\n    [key: string]: Array<Function>;\n}\n\nclass PubSub {\n    events: Events;\n\n    constructor() {\n        this.events = {};\n    }\n    subscribe = (event: string, callback: Function) => {\n        if (!this.events.hasOwnProperty(event)) {\n            this.events[event] = [];\n        }\n        return this.events[event].push(callback);\n    };\n\n    publish = (event: string, data: Object = {}) => {\n        if (!this.events.hasOwnProperty(event)) {\n            return [];\n        }\n        return this.events[event].map(callback => callback(data));\n    };\n}\n\nexport default PubSub;\n","const importStrings = {\n    dataclass: `<span class=\"keyword\">from</span> <span class=\"class-name\">dataclasses</span> <span class=\"keyword\">import</span> <span class=\"class-name\">dataclass</span>`,\n    list: `<span class=\"keyword\">from</span> <span class=\"class-name\">typing</span> <span class=\"keyword\">import</span> <span class=\"class-name\">List</span>`,\n    union: `<span class=\"keyword\">from</span> <span class=\"class-name\">typing</span> <span class=\"keyword\">import</span> <span class=\"class-name\">Union</span>`,\n    datetime: `<span class=\"keyword\">import</span> <span class=\"class-name\">datetime</span>`,\n};\n\nclass PythonOutput {\n    elem: HTMLInputElement;\n    imports: string[];\n    data: string;\n    includeImports: boolean;\n    datetime: boolean;\n    snakeCase: boolean;\n\n    constructor() {\n        this.elem = document.querySelector('.js-python-output');\n        this.imports = [];\n        this.includeImports = false;\n        this.datetime = false;\n        this.snakeCase = true;\n        this.data = '';\n        this.addEventListeners();\n    }\n\n    addEventListeners = () => {\n        this.elem.addEventListener('keydown', this.onKeyDown);\n    };\n\n    onKeyDown = (e: KeyboardEvent) => {\n        if (!~[37, 38, 39, 40].indexOf(e.keyCode) && !e.ctrlKey && !e.metaKey) {\n            e.preventDefault();\n        }\n    };\n\n    setData = (data: string) => {\n        this.data = data;\n        this.update();\n    };\n\n    toggleIncludeImports = () => {\n        this.includeImports = !this.includeImports;\n        if (this.data != '') {\n            this.update();\n        }\n    };\n\n    toggleDatetime = () => {\n        this.datetime = !this.datetime;\n        if (this.data != '') {\n            this.update();\n        }\n    };\n\n    errorMessage = (message: string) => {\n        this.elem.innerHTML = message;\n    };\n\n    toggleCaseStyle = () => {\n        this.snakeCase = !this.snakeCase;\n        if (this.data != '') {\n            this.update();\n        }\n    };\n\n    update = () => {\n        if (this.data != '') {\n            this.elem.innerHTML = '';\n            const objs = [];\n            const data = JSON.parse(this.data);\n            this.findObjs(data, objs);\n            let output = '';\n\n            if (this.includeImports) {\n                if (this.datetime) {\n                    output += importStrings.datetime;\n                    output += '<br>';\n                }\n                if (this.imports.length > 0) {\n                    for (const i of this.imports) {\n                        output += importStrings[i];\n                        output += '<br>';\n                    }\n                }\n                output += importStrings.dataclass;\n                output += '<br><br>';\n            }\n            for (const obj of objs) {\n                output += this.createClass(obj);\n                output += '<br><br>';\n            }\n            this.elem.innerHTML = output;\n        } else {\n            this.elem.innerHTML = '';\n        }\n    };\n\n    findObjs = (data: object, agg: object[], parent: string = 'GeneratedClass'): void => {\n        let obj = {};\n        obj[parent] = {};\n        for (const key in data) {\n            if (data[key] !== null && data[key] instanceof Array) {\n                if (this.imports.indexOf('list') == -1) {\n                    this.imports.push('list');\n                }\n                let listTypes = new Set();\n                for (const item of data[key]) {\n                    if (\n                        typeof item === 'boolean' ||\n                        typeof item === 'number' ||\n                        typeof item === 'string' ||\n                        item instanceof String\n                    ) {\n                        listTypes.add(findType(item, this.datetime));\n                    } else {\n                        const className = key.charAt(0).toUpperCase() + key.slice(1);\n                        listTypes.add(`${className}`);\n                        for (const item of data[key]) {\n                            this.findObjs(item, agg, key);\n                        }\n                    }\n                }\n                if (listTypes.size < 1) {\n                    obj[parent][key] = `List`;\n                } else if (listTypes.size > 1) {\n                    if (this.imports.indexOf('union') == -1) {\n                        this.imports.push('union');\n                    }\n                    let typeArr = Array.from(listTypes.values());\n                    obj[parent][key] = `List[Union[${typeArr.join(', ')}]]`;\n                } else {\n                    obj[parent][key] = `List[${listTypes.values().next().value}]`;\n                }\n            } else if (data[key] !== null && typeof data[key] == 'object') {\n                obj[parent][key] = properCase(key);\n                this.findObjs(data[key], agg, key);\n            } else {\n                obj[parent][key] = findType(data[key], this.datetime);\n            }\n        }\n\n        agg.push(obj);\n    };\n\n    createClass = (data: object): string => {\n        const name = Object.keys(data)[0];\n        const obj = data[name];\n        let types = '';\n        for (const [key, value] of Object.entries(obj)) {\n            let keyName = key;\n            if (this.snakeCase) {\n                keyName = key\n                    .split(/(?=[A-Z])/)\n                    .join('_')\n                    .toLowerCase();\n            }\n            const line = `&nbsp&nbsp&nbsp&nbsp${keyName}: <span class=\"type\">${value}</span>`;\n            types += line;\n            types += '<br>';\n        }\n        let classText = '<span class=\"dataclass\">@dataclass</span><br>';\n        let titleName = name;\n        if (name[0] != name[0].toUpperCase()) {\n            titleName = properCase(name);\n        }\n        classText += `<span class=\"keyword\">class</span> <span class=\"class-name\">${titleName}</span>:`;\n        classText += '<br>';\n        classText += types;\n        return classText;\n    };\n}\n\nconst properCase = (word: string): string => {\n    return word.charAt(0).toUpperCase() + word.substr(1).toLowerCase();\n};\n\nconst findType = (data: boolean | number | String, datetime: boolean): string => {\n    if (typeof data === 'string' || data instanceof String) {\n        const regex = RegExp(/^\\d{4}(-\\d\\d(-\\d\\d(T\\d\\d:\\d\\d(:\\d\\d)?(\\.\\d+)?(([+-]\\d\\d:\\d\\d)|Z)?)?)?)?$/i);\n        const match = data.match(regex);\n        if (datetime && match) {\n            return 'datetime.datetime';\n        }\n        return 'str';\n    }\n    if (typeof data === 'number' && isFinite(data)) {\n        if (data % 1 === 0) {\n            return 'int';\n        } else {\n            return 'float';\n        }\n    }\n    if (typeof data == 'boolean') {\n        return 'bool';\n    }\n    return 'str';\n};\n\nexport default PythonOutput;\n","import PubSub from './pubsub';\nimport PythonOutput from './python-output';\nimport JSONInput from './json-input';\nimport ImportToggle from './import-toggle';\nimport DatetimeToggle from './datetime-toggle';\nimport SnakeCaseToggle from './snake-case-toggle';\nimport Modal from './modal';\n\nconst pubSub = new PubSub();\nconst pythonOutput = new PythonOutput();\nnew JSONInput(pubSub);\nnew ImportToggle(pubSub);\nnew DatetimeToggle(pubSub);\nnew SnakeCaseToggle(pubSub);\nnew Modal();\n\npubSub.subscribe('enter-json', pythonOutput.setData);\npubSub.subscribe('toggle-import', pythonOutput.toggleIncludeImports);\npubSub.subscribe('toggle-datetime', pythonOutput.toggleDatetime);\npubSub.subscribe('toggle-snake-case', pythonOutput.toggleCaseStyle);\npubSub.subscribe('json-error', pythonOutput.errorMessage);\n","import PubSub from './pubsub';\n\nclass JSONInput {\n    pubSub: PubSub;\n    elem: HTMLInputElement;\n\n    constructor(pubSub: PubSub) {\n        this.pubSub = pubSub;\n        this.elem = document.querySelector('.js-json-input');\n        this.addEventListeners();\n    }\n\n    addEventListeners = () => {\n        this.elem.addEventListener('input', this.onInput);\n    };\n\n    onInput = () => {\n        try {\n            JSON.parse(this.elem.value);\n            this.pubSub.publish('enter-json', this.elem.value);\n        } catch (e) {\n            this.pubSub.publish('json-error', `<span class=\"error-message\">${e.message}:<br>${this.elem.value}<span>`);\n        }\n    };\n}\n\nexport default JSONInput;\n","import PubSub from './pubsub';\n\nclass ImportToggle {\n    elem: HTMLInputElement;\n    pubSub: PubSub;\n\n    constructor(pubSub: PubSub) {\n        this.elem = document.getElementById('import-toggle') as HTMLInputElement;\n        this.pubSub = pubSub;\n        this.addEventListeners();\n    }\n\n    addEventListeners = () => {\n        this.elem.addEventListener('change', this.onChange);\n    };\n\n    onChange = () => {\n        this.pubSub.publish('toggle-import');\n    };\n}\n\nexport default ImportToggle;\n","import PubSub from './pubsub';\n\nclass DatetimeToggle {\n    elem: HTMLInputElement;\n    pubSub: PubSub;\n\n    constructor(pubSub: PubSub) {\n        this.elem = document.getElementById('datetime-toggle') as HTMLInputElement;\n        this.pubSub = pubSub;\n        this.addEventListeners();\n    }\n\n    addEventListeners = () => {\n        this.elem.addEventListener('change', this.onChange);\n    };\n\n    onChange = () => {\n        this.pubSub.publish('toggle-datetime');\n    };\n}\n\nexport default DatetimeToggle;\n","import PubSub from './pubsub';\n\nclass SnakeCaseToggle {\n    elem: HTMLInputElement;\n    pubSub: PubSub;\n\n    constructor(pubSub: PubSub) {\n        this.elem = document.getElementById('snake-case-toggle') as HTMLInputElement;\n        this.pubSub = pubSub;\n        this.addEventListeners();\n    }\n\n    addEventListeners = () => {\n        this.elem.addEventListener('change', this.onChange);\n    };\n\n    onChange = () => {\n        this.pubSub.publish('toggle-snake-case');\n    };\n}\n\nexport default SnakeCaseToggle;\n","class Modal {\n    modal: HTMLElement;\n    modalBody: HTMLElement;\n    background: HTMLElement;\n    modalBtn: HTMLElement;\n    closeBtn: HTMLButtonElement;\n\n    constructor() {\n        this.modal = document.querySelector('.js-modal');\n        this.modalBody = document.querySelector('.js-modal__body');\n        this.background = document.querySelector('.js-modal__background');\n        this.modalBtn = document.querySelector('.about');\n        this.closeBtn = document.querySelector('.js-close-btn');\n        this.addEventListeners();\n    }\n\n    addEventListeners = () => {\n        this.modalBtn.addEventListener('click', this.show);\n        this.background.addEventListener('click', this.close);\n        this.closeBtn.addEventListener('click', this.close);\n    };\n\n    show = () => {\n        this.modal.classList.add('modal--visible');\n        this.background.classList.add('modal__background--visible');\n        this.modalBody.classList.add('modal__body--visible');\n    };\n\n    close = () => {\n        this.modal.classList.remove('modal--visible');\n        this.background.classList.remove('modal__background--visible');\n        this.modalBody.classList.remove('modal__body--visible');\n    };\n}\n\nexport default Modal;\n"],"names":["importStrings","dataclass","list","union","datetime","properCase","word","charAt","toUpperCase","substr","toLowerCase","findType","data","String","regex","RegExp","match","isFinite","pubSub","constructor","event","callback","this","events","hasOwnProperty","push","map","pythonOutput","elem","addEventListener","onKeyDown","e","indexOf","keyCode","ctrlKey","metaKey","preventDefault","update","includeImports","message","innerHTML","snakeCase","objs","JSON","parse","findObjs","output","imports","length","createClass","agg","parent","obj","const","key","Array","listTypes","Set","item","add","className","slice","size","typeArr","from","values","join","next","name","Object","keys","types","entries","keyName","split","value","classText","titleName","document","querySelector","addEventListeners","onInput","publish","onChange","getElementById","modalBtn","show","background","close","closeBtn","modal","classList","modalBody","remove","subscribe","setData","toggleIncludeImports","toggleDatetime","toggleCaseStyle","errorMessage"],"mappings":"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"}